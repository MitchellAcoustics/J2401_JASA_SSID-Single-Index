<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.553">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Load Data</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Load Data</h6>

            <a href="../notebooks/skewnorm_test.ipynb" class="btn btn-primary quarto-download-embed" download="skewnorm_test.ipynb">Download Notebook</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Load Data</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#calculate-iso-coordinates" id="toc-calculate-iso-coordinates" class="nav-link active" data-scroll-target="#calculate-iso-coordinates">Calculate ISO Coordinates</a>
  <ul class="collapse">
  <li><a href="#standard-iso-projection" id="toc-standard-iso-projection" class="nav-link" data-scroll-target="#standard-iso-projection">Standard ISO Projection</a></li>
  <li><a href="#satp-iso-projection" id="toc-satp-iso-projection" class="nav-link" data-scroll-target="#satp-iso-projection">SATP ISO Projection</a></li>
  <li><a href="#ssm-method" id="toc-ssm-method" class="nav-link" data-scroll-target="#ssm-method">SSM Method</a></li>
  </ul></li>
  <li><a href="#testing-the-distribution-methods" id="toc-testing-the-distribution-methods" class="nav-link" data-scroll-target="#testing-the-distribution-methods">Testing the distribution methods</a></li>
  <li><a href="#usage-examples" id="toc-usage-examples" class="nav-link" data-scroll-target="#usage-examples">Usage Examples</a></li>
  <li><a href="#truncated-skew-normal" id="toc-truncated-skew-normal" class="nav-link" data-scroll-target="#truncated-skew-normal">Truncated Skew-Normal</a></li>
  <li><a href="#multivariate-skew-normal" id="toc-multivariate-skew-normal" class="nav-link" data-scroll-target="#multivariate-skew-normal">Multivariate Skew-Normal</a>
  <ul class="collapse">
  <li><a href="#r-sn" id="toc-r-sn" class="nav-link" data-scroll-target="#r-sn">R SN</a></li>
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">End</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [242]:</pre></div><div id="initial_id" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-04T11:57:55.725941Z&quot;,&quot;start_time&quot;:&quot;2024-02-04T11:57:55.701212Z&quot;}" data-execution_count="242">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> soundscapy <span class="im">as</span> sspy</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpyskewnorm <span class="im">as</span> snpy</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipydists <span class="im">as</span> dists</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> soundscapy.utils.parameters <span class="im">import</span> PAQ_IDS, LANGUAGE_ANGLES</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> circumplex <span class="im">as</span> cx</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> spi</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [243]:</pre></div><div id="752b6f9909f01867" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-04T11:58:18.673493Z&quot;,&quot;start_time&quot;:&quot;2024-02-04T11:58:04.477224Z&quot;}" data-execution_count="243">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load latest ISD dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data = sspy.isd.load_zenodo()</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load latest ISD dataset</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>isd_file <span class="op">=</span> Path(<span class="st">"ISD v1.0 Data.csv"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(isd_file)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data, excl_data <span class="op">=</span> sspy.isd.validate(data)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.query(<span class="st">"Language != 'cmn'"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude RegentsParkJapan outliers</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># excl_id = list(data.query("LocationID == 'RegentsParkJapan'").query("ISOEventful &gt; 0.72 | ISOEventful &lt; -0.5").index)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluded RegentsParkFields outliers</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># excl_id = excl_id + list(data.query("LocationID == 'RegentsParkFields' and ISOPleasant &lt; 0").index) # Helicopters</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>excl_id <span class="op">=</span> [<span class="dv">652</span>, <span class="dv">706</span>, <span class="dv">548</span>, <span class="dv">550</span>, <span class="dv">551</span>, <span class="dv">553</span>, <span class="dv">569</span>, <span class="dv">580</span>, <span class="dv">609</span>, <span class="dv">618</span>, <span class="dv">623</span>, <span class="dv">636</span>, <span class="dv">643</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>data.drop(excl_id, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Renaming PAQ columns.
Checking PAQ data quality.
Identified 109 samples to remove.
[6, 9, 13, 30, 32, 46, 190, 213, 229, 244, 296, 412, 413, 428, 464, 485, 655, 734, 739, 762, 766, 780, 1067, 1274, 1290, 1316, 1320, 1338, 1346, 1347, 1397, 1425, 1431, 1446, 1447, 1470, 1485, 1491, 1504, 1505, 1510, 1512, 1517, 1522, 1523, 1527, 1599, 1698, 1734, 1817, 1911, 1948, 2069, 2107, 2109, 2111, 2150, 2199, 2277, 2293, 2384, 2386, 2490, 2523, 2584, 2592, 2695, 2762, 2767, 2783, 2789, 2825, 2826, 2832, 2840, 2856, 2859, 2879, 2883, 2889, 2910, 2932, 2956, 2969, 3031, 3058, 3077, 3124, 3149, 3163, 3185, 3202, 3210, 3211, 3212, 3213, 3214, 3215, 3216, 3272, 3302, 3365, 3414, 3491, 3502, 3510, 3517, 3533, 3583]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="243">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LocationID</th>
<th data-quarto-table-cell-role="th">SessionID</th>
<th data-quarto-table-cell-role="th">GroupID</th>
<th data-quarto-table-cell-role="th">RecordID</th>
<th data-quarto-table-cell-role="th">start_time</th>
<th data-quarto-table-cell-role="th">end_time</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">Language</th>
<th data-quarto-table-cell-role="th">Survey_Version</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">RA_cp90</th>
<th data-quarto-table-cell-role="th">RA_cp95</th>
<th data-quarto-table-cell-role="th">THD_THD</th>
<th data-quarto-table-cell-role="th">THD_Min</th>
<th data-quarto-table-cell-role="th">THD_Max</th>
<th data-quarto-table-cell-role="th">THD_L5</th>
<th data-quarto-table-cell-role="th">THD_L10</th>
<th data-quarto-table-cell-role="th">THD_L50</th>
<th data-quarto-table-cell-role="th">THD_L90</th>
<th data-quarto-table-cell-role="th">THD_L95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CarloV</td>
<td>CarloV2</td>
<td>2CV12</td>
<td>1434</td>
<td>2019-05-16 18:46:00</td>
<td>2019-05-16 18:56:00</td>
<td>37.17685</td>
<td>-3.590392</td>
<td>eng</td>
<td>engISO2018</td>
<td>...</td>
<td>8.15</td>
<td>6.72</td>
<td>-0.09</td>
<td>-11.76</td>
<td>54.18</td>
<td>34.82</td>
<td>26.53</td>
<td>5.57</td>
<td>-9.00</td>
<td>-10.29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CarloV</td>
<td>CarloV2</td>
<td>2CV12</td>
<td>1435</td>
<td>2019-05-16 18:46:00</td>
<td>2019-05-16 18:56:00</td>
<td>37.17685</td>
<td>-3.590392</td>
<td>eng</td>
<td>engISO2018</td>
<td>...</td>
<td>8.15</td>
<td>6.72</td>
<td>-0.09</td>
<td>-11.76</td>
<td>54.18</td>
<td>34.82</td>
<td>26.53</td>
<td>5.57</td>
<td>-9.00</td>
<td>-10.29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CarloV</td>
<td>CarloV2</td>
<td>2CV13</td>
<td>1430</td>
<td>2019-05-16 19:02:00</td>
<td>2019-05-16 19:12:00</td>
<td>37.17685</td>
<td>-3.590392</td>
<td>eng</td>
<td>engISO2018</td>
<td>...</td>
<td>5.00</td>
<td>3.91</td>
<td>-2.10</td>
<td>-19.32</td>
<td>72.52</td>
<td>32.33</td>
<td>24.52</td>
<td>0.25</td>
<td>-16.30</td>
<td>-17.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CarloV</td>
<td>CarloV2</td>
<td>2CV13</td>
<td>1431</td>
<td>2019-05-16 19:02:00</td>
<td>2019-05-16 19:12:00</td>
<td>37.17685</td>
<td>-3.590392</td>
<td>eng</td>
<td>engISO2018</td>
<td>...</td>
<td>5.00</td>
<td>3.91</td>
<td>-2.10</td>
<td>-19.32</td>
<td>72.52</td>
<td>32.33</td>
<td>24.52</td>
<td>0.25</td>
<td>-16.30</td>
<td>-17.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CarloV</td>
<td>CarloV2</td>
<td>2CV13</td>
<td>1432</td>
<td>2019-05-16 19:02:00</td>
<td>2019-05-16 19:12:00</td>
<td>37.17685</td>
<td>-3.590392</td>
<td>eng</td>
<td>engISO2018</td>
<td>...</td>
<td>5.00</td>
<td>3.91</td>
<td>-2.10</td>
<td>-19.32</td>
<td>72.52</td>
<td>32.33</td>
<td>24.52</td>
<td>0.25</td>
<td>-16.30</td>
<td>-17.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1693</td>
<td>Noorderplantsoen</td>
<td>Noorderplantsoen1</td>
<td>NP161</td>
<td>61</td>
<td>2020-03-11 12:42:00</td>
<td>2020-03-11 12:55:00</td>
<td>NaN</td>
<td>NaN</td>
<td>nld</td>
<td>nldSSIDv1</td>
<td>...</td>
<td>2.54</td>
<td>2.00</td>
<td>-3.17</td>
<td>-11.97</td>
<td>59.64</td>
<td>37.87</td>
<td>26.54</td>
<td>6.33</td>
<td>-9.79</td>
<td>-10.34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1694</td>
<td>Noorderplantsoen</td>
<td>Noorderplantsoen1</td>
<td>NP162</td>
<td>63</td>
<td>2020-03-11 12:39:00</td>
<td>2020-03-11 13:00:00</td>
<td>NaN</td>
<td>NaN</td>
<td>nld</td>
<td>nldSSIDv1</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1695</td>
<td>Noorderplantsoen</td>
<td>Noorderplantsoen1</td>
<td>NP162</td>
<td>62</td>
<td>2020-03-11 12:54:00</td>
<td>2020-03-11 12:58:00</td>
<td>NaN</td>
<td>NaN</td>
<td>nld</td>
<td>nldSSIDv1</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1696</td>
<td>Noorderplantsoen</td>
<td>Noorderplantsoen1</td>
<td>NP162</td>
<td>64</td>
<td>2020-03-11 12:56:00</td>
<td>2020-03-11 12:59:00</td>
<td>NaN</td>
<td>NaN</td>
<td>nld</td>
<td>nldSSIDv1</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1697</td>
<td>Noorderplantsoen</td>
<td>Noorderplantsoen1</td>
<td>NP163</td>
<td>70</td>
<td>2020-03-11 23:08:00</td>
<td>2020-03-11 23:18:00</td>
<td>NaN</td>
<td>NaN</td>
<td>nld</td>
<td>nldSSIDv1</td>
<td>...</td>
<td>2.58</td>
<td>1.99</td>
<td>-3.20</td>
<td>-9.67</td>
<td>57.99</td>
<td>35.54</td>
<td>29.32</td>
<td>8.86</td>
<td>-5.61</td>
<td>-6.71</td>
</tr>
</tbody>
</table>

<p>1638 rows Ã— 142 columns</p>
</div>
</div>
</div>
</div></div>
<section id="calculate-iso-coordinates" class="level2">
<h2 class="anchored" data-anchor-id="calculate-iso-coordinates">Calculate ISO Coordinates</h2>
<section id="standard-iso-projection" class="level3">
<h3 class="anchored" data-anchor-id="standard-iso-projection">Standard ISO Projection</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [304]:</pre></div><div id="862ac85dc0fbf154" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-04T11:58:28.916291Z&quot;,&quot;start_time&quot;:&quot;2024-02-04T11:58:27.497952Z&quot;}" data-execution_count="304">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>iso_data <span class="op">=</span> data.copy()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>iso_data <span class="op">=</span> sspy.surveys.add_iso_coords(iso_data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(iso_data, xlim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="skewnorm_test_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="satp-iso-projection" class="level3">
<h3 class="anchored" data-anchor-id="satp-iso-projection">SATP ISO Projection</h3>
<p>Using corrected angles</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [306]:</pre></div><div id="9009734a" class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>satp_data <span class="op">=</span> data.copy()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> satp_data.iterrows():</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    lang <span class="op">=</span> row[<span class="st">'Language'</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    angles <span class="op">=</span> LANGUAGE_ANGLES[lang]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    iso_pl, iso_ev <span class="op">=</span> sspy.surveys.adj_iso_pl(row[PAQ_IDS], angles, scale<span class="op">=</span><span class="dv">4</span>), sspy.surveys.adj_iso_ev(row[PAQ_IDS], angles, scale<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    satp_data.loc[i, <span class="st">'ISOPleasant'</span>] <span class="op">=</span> iso_pl</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    satp_data.loc[i, <span class="st">'ISOEventful'</span>] <span class="op">=</span> iso_ev</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(satp_data, xlim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="skewnorm_test_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="ssm-method" class="level3">
<h3 class="anchored" data-anchor-id="ssm-method">SSM Method</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [302]:</pre></div><div id="75fecfb7" class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ssm_coords(items: np.array, angles: <span class="bu">tuple</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    ssm_params <span class="op">=</span> cx.ssm_parameters(items, angles)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ssm_params[<span class="dv">1</span>:<span class="dv">3</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> <span class="fl">0.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [303]:</pre></div><div id="ac1c704f" class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ssm_data <span class="op">=</span> data.copy()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> ssm_data.iterrows():</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    coords <span class="op">=</span> ssm_coords((row[PAQ_IDS] <span class="op">-</span> <span class="dv">3</span>) <span class="op">/</span> <span class="dv">2</span>, angles<span class="op">=</span>cx.OCTANTS)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    ssm_data.loc[i, [<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]] <span class="op">=</span> coords</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(ssm_data, xlim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-7-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="skewnorm_test_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [308]:</pre></div><div id="c3c51059" class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ssm_satp_data <span class="op">=</span> data.copy()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> ssm_data.iterrows():</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    lang <span class="op">=</span> row[<span class="st">'Language'</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    angles <span class="op">=</span> LANGUAGE_ANGLES[lang]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    coords <span class="op">=</span> ssm_coords((row[PAQ_IDS] <span class="op">-</span> <span class="dv">3</span>) <span class="op">/</span> <span class="dv">2</span>, angles)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    ssm_satp_data.loc[i, [<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]] <span class="op">=</span> coords</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># coords = data.apply(lambda x: ssm_coords(x[PAQ_IDS] * scale, LANGUAGE_ANGLES['eng']), axis=1)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ssm_data[['ISOPleasant', 'ISOPleasant']] = coords</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(ssm_satp_data, xlim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), ylim<span class="op">=</span>(<span class="op">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="skewnorm_test_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="testing-the-distribution-methods" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-distribution-methods">Testing the distribution methods</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [309]:</pre></div><div id="ba679f393f640213" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-04T11:59:16.171018Z&quot;,&quot;start_time&quot;:&quot;2024-02-04T11:58:30.409310Z&quot;}" data-execution_count="309">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_benchmark(data):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_data, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_msn(data):</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fit selm model to get parameters</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            loc_m <span class="op">=</span> snpy.selm(<span class="st">"ISOPleasant"</span>, <span class="st">"ISOEventful"</span>, data<span class="op">=</span>loc_data)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Error in selm fit for: "</span>, location)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>            loc_Y <span class="op">=</span> snpy.sample_msn(loc_m, n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Error in sample_msn for: "</span>, location)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_mtsn(data):</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fit selm model to get parameters</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>            loc_m <span class="op">=</span> snpy.selm(<span class="st">"ISOPleasant"</span>, <span class="st">"ISOEventful"</span>, data<span class="op">=</span>loc_data)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Error in selm fit for: "</span>, location)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>            loc_Y <span class="op">=</span> snpy.sample_mtsn(loc_m, n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Error in sample_mtsn for: "</span>, location)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_scipy_tsn(data):</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fit selm model to get parameters</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>        loc, scale, alpha <span class="op">=</span> dists.estimate_skew_moments_2d(loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy())</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> dists.scipy_tsn_2d(loc, scale, alpha, num_samples<span class="op">=</span><span class="dv">1000</span>)            </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_scipy_msn(data):</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>        mean, cov, skew <span class="op">=</span> dists.estimate_msn_moments(</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>            loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy()</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> dists.scipy_msn(shape<span class="op">=</span>skew, cov<span class="op">=</span>cov, mean<span class="op">=</span>mean).rvs_slow(<span class="dv">1000</span>)</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_scipy_mn(data):</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>        mean, cov, _ <span class="op">=</span> dists.estimate_msn_moments(</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>            loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy()</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> dists.scipy_mn(mean, cov, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_scipy_mtn(data):</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>        mean, cov, _ <span class="op">=</span> dists.estimate_msn_moments(</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>            loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy()</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> dists.scipy_mtn(mean, cov, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> try_scipy_tn(data):</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> {}</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> location <span class="kw">in</span> data.LocationID.unique():</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>        <span class="co"># split out location data</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>        loc_data <span class="op">=</span> sspy.isd.select_location_ids(data, location)[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]]</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>        mean <span class="op">=</span> loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].mean().to_numpy()</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>        stddev <span class="op">=</span> loc_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].std().to_numpy()</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> dists.scipy_tn_2d(mean, stddev, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>        loc_Y <span class="op">=</span> pd.DataFrame(loc_Y, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>        res[location] <span class="op">=</span> utils.ks2d2s(loc_data, loc_Y, extra<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> pd.DataFrame.from_dict(res, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>[<span class="st">"p"</span>, <span class="st">"D"</span>])</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [310]:</pre></div><div id="0800b34e" class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Running benchmarks for ISO"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>iso_res <span class="op">=</span> {}</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'benchmark'</span>] <span class="op">=</span> try_benchmark(iso_data)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'msn'</span>] <span class="op">=</span> try_msn(iso_data)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'mtsn'</span>] <span class="op">=</span> try_mtsn(iso_data)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'scipy_mn'</span>] <span class="op">=</span> try_scipy_mn(iso_data)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'scipy_tn'</span>] <span class="op">=</span> try_scipy_tn(iso_data)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'scipy_mtn'</span>] <span class="op">=</span> try_scipy_mtn(iso_data)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'scipy_tsn'</span>] <span class="op">=</span> try_scipy_tsn(iso_data)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>iso_res[<span class="st">'scipy_msn'</span>] <span class="op">=</span> try_scipy_msn(iso_data)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Running benchmarks for SATP"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>satp_res <span class="op">=</span> {}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'benchmark'</span>] <span class="op">=</span> try_benchmark(satp_data)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'msn'</span>] <span class="op">=</span> try_msn(satp_data)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'mtsn'</span>] <span class="op">=</span> try_mtsn(satp_data)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'scipy_mn'</span>] <span class="op">=</span> try_scipy_mn(satp_data)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'scipy_tn'</span>] <span class="op">=</span> try_scipy_tn(satp_data)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'scipy_mtn'</span>] <span class="op">=</span> try_scipy_mtn(satp_data)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'scipy_tsn'</span>] <span class="op">=</span> try_scipy_tsn(satp_data)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>satp_res[<span class="st">'scipy_msn'</span>] <span class="op">=</span> try_scipy_msn(satp_data)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Running benchmarks for SSM"</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>ssm_res <span class="op">=</span> {}</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'benchmark'</span>] <span class="op">=</span> try_benchmark(ssm_data)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'msn'</span>] <span class="op">=</span> try_msn(ssm_data)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'mtsn'</span>] <span class="op">=</span> try_mtsn(ssm_data)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'scipy_mn'</span>] <span class="op">=</span> try_scipy_mn(ssm_data)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'scipy_tn'</span>] <span class="op">=</span> try_scipy_tn(ssm_data)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'scipy_mtn'</span>] <span class="op">=</span> try_scipy_mtn(ssm_data)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'scipy_tsn'</span>] <span class="op">=</span> try_scipy_tsn(ssm_data)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>ssm_res[<span class="st">'scipy_msn'</span>] <span class="op">=</span> try_scipy_msn(ssm_data)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Running benchmarks for SSM_SATP"</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>ssm_satp_res <span class="op">=</span> {}</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'benchmark'</span>] <span class="op">=</span> try_benchmark(ssm_satp_data)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'msn'</span>] <span class="op">=</span> try_msn(ssm_satp_data)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'mtsn'</span>] <span class="op">=</span> try_mtsn(ssm_satp_data)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'scipy_mn'</span>] <span class="op">=</span> try_scipy_mn(ssm_satp_data)  </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'scipy_tn'</span>] <span class="op">=</span> try_scipy_tn(ssm_satp_data)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'scipy_mtn'</span>] <span class="op">=</span> try_scipy_mtn(ssm_satp_data)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'scipy_tsn'</span>] <span class="op">=</span> try_scipy_tsn(ssm_satp_data)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>ssm_satp_res[<span class="st">'scipy_msn'</span>] <span class="op">=</span> try_scipy_msn(ssm_satp_data)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>iso_res <span class="op">=</span> pd.concat(iso_res, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>satp_res <span class="op">=</span> pd.concat(satp_res, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>ssm_res <span class="op">=</span> pd.concat(ssm_res, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>ssm_satp_res <span class="op">=</span> pd.concat(ssm_satp_res, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running benchmarks for ISO
Error in sample_msn for:  RegentsParkJapan
Error in sample_mtsn for:  RegentsParkJapan
Running benchmarks for SATP
Running benchmarks for SSM
Running benchmarks for SSM_SATP</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>R[write to console]: Error in chol.default(lot$aux$Psi) : 
  the leading minor of order 2 is not positive

R[write to console]: Error in chol.default(lot$aux$Psi) : 
  the leading minor of order 2 is not positive
</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [311]:</pre></div><div id="231c96c7" class="cell" data-execution_count="311">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"iso"</span>: iso_res.mean(),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"satp"</span>: satp_res.mean(),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssm"</span>: ssm_res.mean(),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssm_satp"</span>: ssm_satp_res.mean()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">satp</th>
<th data-quarto-table-cell-role="th">ssm</th>
<th data-quarto-table-cell-role="th">ssm_satp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">benchmark</td>
<td data-quarto-table-cell-role="th">p</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.015185</td>
<td>0.015185</td>
<td>0.015185</td>
<td>0.015185</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">msn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.465357</td>
<td>0.562509</td>
<td>0.486952</td>
<td>0.456373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.118309</td>
<td>0.109810</td>
<td>0.116221</td>
<td>0.119853</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">mtsn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.433930</td>
<td>0.442268</td>
<td>0.229574</td>
<td>0.239475</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.122008</td>
<td>0.126246</td>
<td>0.164551</td>
<td>0.158554</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">scipy_mn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.305868</td>
<td>0.349701</td>
<td>0.349431</td>
<td>0.360433</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.138710</td>
<td>0.134823</td>
<td>0.133068</td>
<td>0.132576</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">scipy_tn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.003758</td>
<td>0.006717</td>
<td>0.004066</td>
<td>0.001909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.325064</td>
<td>0.315896</td>
<td>0.321632</td>
<td>0.326232</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">scipy_mtn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.279799</td>
<td>0.263552</td>
<td>0.123244</td>
<td>0.186736</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.148024</td>
<td>0.158660</td>
<td>0.197856</td>
<td>0.180046</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">scipy_tsn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.376730</td>
<td>0.352066</td>
<td>0.236838</td>
<td>0.329696</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.127551</td>
<td>0.135906</td>
<td>0.163057</td>
<td>0.144473</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">scipy_msn</td>
<td data-quarto-table-cell-role="th">p</td>
<td>0.176612</td>
<td>0.222497</td>
<td>0.129377</td>
<td>0.183064</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">D</td>
<td>0.191251</td>
<td>0.184408</td>
<td>0.207325</td>
<td>0.198188</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [301]:</pre></div><div id="f69a5359" class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ssm_satp_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="301">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">benchmark</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">msn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">mtsn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">scipy_mn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">scipy_tn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">scipy_mtn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">scipy_tsn</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">scipy_msn</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">p</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CarloV</td>
<td>1.0</td>
<td>0.008621</td>
<td>0.332220</td>
<td>0.108948</td>
<td>0.415114</td>
<td>0.101862</td>
<td>0.138097</td>
<td>0.133224</td>
<td>2.205885e-08</td>
<td>0.348931</td>
<td>0.008025</td>
<td>0.191466</td>
<td>0.212666</td>
<td>0.122017</td>
<td>2.190545e-04</td>
<td>0.246052</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SanMarco</td>
<td>1.0</td>
<td>0.010526</td>
<td>0.187876</td>
<td>0.136500</td>
<td>0.124164</td>
<td>0.147947</td>
<td>0.571675</td>
<td>0.098316</td>
<td>5.307215e-07</td>
<td>0.345447</td>
<td>0.080655</td>
<td>0.159026</td>
<td>0.224133</td>
<td>0.131289</td>
<td>2.340935e-01</td>
<td>0.129974</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PlazaBibRambla</td>
<td>1.0</td>
<td>0.055556</td>
<td>0.386987</td>
<td>0.230389</td>
<td>0.408058</td>
<td>0.226556</td>
<td>0.375052</td>
<td>0.232667</td>
<td>2.386168e-02</td>
<td>0.379222</td>
<td>0.264264</td>
<td>0.256222</td>
<td>0.692309</td>
<td>0.181278</td>
<td>2.622090e-02</td>
<td>0.375167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CamdenTown</td>
<td>1.0</td>
<td>0.009524</td>
<td>0.554649</td>
<td>0.095452</td>
<td>0.123191</td>
<td>0.142024</td>
<td>0.321463</td>
<td>0.114833</td>
<td>6.329528e-07</td>
<td>0.329119</td>
<td>0.162824</td>
<td>0.134690</td>
<td>0.111287</td>
<td>0.144571</td>
<td>1.885080e-01</td>
<td>0.130667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EustonTap</td>
<td>1.0</td>
<td>0.010417</td>
<td>0.539653</td>
<td>0.100333</td>
<td>0.214952</td>
<td>0.131958</td>
<td>0.405129</td>
<td>0.111375</td>
<td>8.278754e-08</td>
<td>0.364375</td>
<td>0.454078</td>
<td>0.107167</td>
<td>0.276429</td>
<td>0.124250</td>
<td>3.744412e-01</td>
<td>0.114167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Noorderplantsoen</td>
<td>1.0</td>
<td>0.010309</td>
<td>0.028382</td>
<td>0.181284</td>
<td>0.024192</td>
<td>0.184820</td>
<td>0.065612</td>
<td>0.162593</td>
<td>3.865498e-08</td>
<td>0.370784</td>
<td>0.001203</td>
<td>0.239593</td>
<td>0.393434</td>
<td>0.111918</td>
<td>1.359523e-04</td>
<td>0.272438</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MarchmontGarden</td>
<td>1.0</td>
<td>0.009615</td>
<td>0.391306</td>
<td>0.108846</td>
<td>0.085582</td>
<td>0.151615</td>
<td>0.215849</td>
<td>0.127423</td>
<td>3.223722e-06</td>
<td>0.311962</td>
<td>0.022484</td>
<td>0.180962</td>
<td>0.572758</td>
<td>0.094538</td>
<td>2.035562e-03</td>
<td>0.224231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MonumentoGaribaldi</td>
<td>1.0</td>
<td>0.031250</td>
<td>0.416390</td>
<td>0.176875</td>
<td>0.551950</td>
<td>0.159125</td>
<td>0.603720</td>
<td>0.153000</td>
<td>2.595158e-03</td>
<td>0.365125</td>
<td>0.440012</td>
<td>0.173625</td>
<td>0.397052</td>
<td>0.179625</td>
<td>1.651685e-01</td>
<td>0.223625</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">TateModern</td>
<td>1.0</td>
<td>0.006579</td>
<td>0.047374</td>
<td>0.140842</td>
<td>0.085713</td>
<td>0.129211</td>
<td>0.174530</td>
<td>0.113526</td>
<td>2.649091e-09</td>
<td>0.329184</td>
<td>0.021713</td>
<td>0.154737</td>
<td>0.311808</td>
<td>0.099158</td>
<td>6.014070e-02</td>
<td>0.136132</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PancrasLock</td>
<td>1.0</td>
<td>0.010753</td>
<td>0.053461</td>
<td>0.170430</td>
<td>0.048089</td>
<td>0.172914</td>
<td>0.370769</td>
<td>0.116011</td>
<td>2.052490e-06</td>
<td>0.332586</td>
<td>0.100386</td>
<td>0.154882</td>
<td>0.121358</td>
<td>0.149919</td>
<td>1.956629e-02</td>
<td>0.192522</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">TorringtonSq</td>
<td>1.0</td>
<td>0.008850</td>
<td>0.752887</td>
<td>0.078704</td>
<td>0.504059</td>
<td>0.096230</td>
<td>0.479924</td>
<td>0.098049</td>
<td>4.646734e-07</td>
<td>0.322407</td>
<td>0.544874</td>
<td>0.093279</td>
<td>0.521719</td>
<td>0.094951</td>
<td>3.435695e-01</td>
<td>0.109327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">RegentsParkFields</td>
<td>1.0</td>
<td>0.009346</td>
<td>0.038338</td>
<td>0.167808</td>
<td>0.024889</td>
<td>0.176734</td>
<td>0.033875</td>
<td>0.170421</td>
<td>1.035844e-08</td>
<td>0.368654</td>
<td>0.000144</td>
<td>0.260575</td>
<td>0.007505</td>
<td>0.199463</td>
<td>2.905367e-06</td>
<td>0.309439</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RegentsParkJapan</td>
<td>1.0</td>
<td>0.011236</td>
<td>0.007564</td>
<td>0.215112</td>
<td>0.003696</td>
<td>0.228556</td>
<td>0.008117</td>
<td>0.213657</td>
<td>7.924505e-06</td>
<td>0.321528</td>
<td>0.000008</td>
<td>0.321360</td>
<td>0.014374</td>
<td>0.202534</td>
<td>5.840853e-12</td>
<td>0.469247</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">RussellSq</td>
<td>1.0</td>
<td>0.006897</td>
<td>0.539724</td>
<td>0.084397</td>
<td>0.215597</td>
<td>0.110931</td>
<td>0.066730</td>
<td>0.137086</td>
<td>2.423797e-09</td>
<td>0.336862</td>
<td>0.048743</td>
<td>0.143241</td>
<td>0.387202</td>
<td>0.095052</td>
<td>7.369745e-05</td>
<td>0.237448</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">StPaulsCross</td>
<td>1.0</td>
<td>0.015152</td>
<td>0.559008</td>
<td>0.115697</td>
<td>0.385705</td>
<td>0.132667</td>
<td>0.265800</td>
<td>0.146939</td>
<td>6.053659e-05</td>
<td>0.334379</td>
<td>0.074092</td>
<td>0.188091</td>
<td>0.370314</td>
<td>0.134364</td>
<td>8.955410e-03</td>
<td>0.240924</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">StPaulsRow</td>
<td>1.0</td>
<td>0.013889</td>
<td>0.754768</td>
<td>0.095167</td>
<td>0.470160</td>
<td>0.119667</td>
<td>0.581053</td>
<td>0.109833</td>
<td>5.848892e-06</td>
<td>0.356722</td>
<td>0.393407</td>
<td>0.127111</td>
<td>0.742171</td>
<td>0.096278</td>
<td>5.104034e-01</td>
<td>0.116000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">CampoPrincipe</td>
<td>1.0</td>
<td>0.009091</td>
<td>0.435522</td>
<td>0.102636</td>
<td>0.128669</td>
<td>0.138136</td>
<td>0.024154</td>
<td>0.175318</td>
<td>3.653703e-05</td>
<td>0.275545</td>
<td>0.002124</td>
<td>0.218273</td>
<td>0.208450</td>
<td>0.125409</td>
<td>1.199560e-10</td>
<td>0.404682</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MiradorSanNicolas</td>
<td>1.0</td>
<td>0.035714</td>
<td>0.545286</td>
<td>0.168857</td>
<td>0.621139</td>
<td>0.159143</td>
<td>0.506720</td>
<td>0.173786</td>
<td>1.879414e-03</td>
<td>0.394929</td>
<td>0.587965</td>
<td>0.163357</td>
<td>0.429398</td>
<td>0.184929</td>
<td>3.269021e-01</td>
<td>0.200643</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
<hr>
</section>
<section id="usage-examples" class="level2">
<h2 class="anchored" data-anchor-id="usage-examples">Usage Examples</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [87]:</pre></div><div id="f02dff197456cd80" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T21:14:40.827136Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T21:14:40.805476Z&quot;}" data-execution_count="87">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> sspy.isd.select_location_ids(data, <span class="st">'RegentsParkJapan'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [88]:</pre></div><div id="f2a777e9ac689f10" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T21:14:41.238236Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T21:14:41.182698Z&quot;}" data-execution_count="88">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpyskewnorm <span class="im">as</span> snpy</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> snpy.selm(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="st">"ISOPleasant"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="st">"ISOEventful"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> test_data,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>cp <span class="op">=</span> snpy.extract_cp(m)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>dp <span class="op">=</span> snpy.extract_dp(m)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"mean: </span><span class="sc">{</span>cp[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"cov: </span><span class="sc">{</span>cp[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"skew: </span><span class="sc">{</span>cp[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"xi: </span><span class="sc">{</span>dp[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"omega: </span><span class="sc">{</span>dp[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"alpha: </span><span class="sc">{</span>dp[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mean: [[0.76569249 0.1337267 ]]
cov: [[0.05304569 0.01325881]
 [0.01325881 0.06333638]]
skew: [-0.99252395 -0.00648337]


xi: [[1.07026046 0.19593844]]
omega: [[0.14580734 0.03220651]
 [0.03220651 0.06720668]]
alpha: [-31277540.37912534    848852.67981869]</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [89]:</pre></div><div id="eaa58b131041a74" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T21:14:43.845657Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T21:14:42.194087Z&quot;}" data-execution_count="89">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Y1 <span class="op">=</span> snpy.sample_msn(xi <span class="op">=</span> dp[<span class="dv">0</span>], omega<span class="op">=</span>dp[<span class="dv">1</span>], alpha<span class="op">=</span>dp[<span class="dv">2</span>], n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Y1 <span class="op">=</span> pd.DataFrame(Y1, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Y2 <span class="op">=</span> snpy.sample_msn(m, n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Y2 <span class="op">=</span> pd.DataFrame(Y2, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">3</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(Y1, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(Y2, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(test_data, ax<span class="op">=</span>axes[<span class="dv">2</span>])</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]], Y1))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]], Y2))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(Y1, Y2))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: tuple index out of range</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-15-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="skewnorm_test_files/figure-html/cell-15-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [90]:</pre></div><div id="795dec7aa2e410c3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T21:14:46.005266Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T21:14:43.846732Z&quot;}" data-execution_count="90">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Yt1 <span class="op">=</span> snpy.sample_mtsn(m, n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Yt1 <span class="op">=</span> pd.DataFrame(Yt1, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Yt2 <span class="op">=</span> snpy.sample_mtsn(xi <span class="op">=</span> dp[<span class="dv">0</span>], omega<span class="op">=</span>dp[<span class="dv">1</span>], alpha<span class="op">=</span>dp[<span class="dv">2</span>], n<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>Yt2 <span class="op">=</span> pd.DataFrame(Yt2, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">3</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(Yt1, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(Yt2, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>sspy.plotting.density(test_data, ax<span class="op">=</span>axes[<span class="dv">2</span>])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]], Yt1))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]], Yt2))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spi(Yt1, Yt2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: tuple index out of range</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-16-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="skewnorm_test_files/figure-html/cell-16-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<p>options explored:</p>
<p>Multivariate Truncated Normal:</p>
<ul>
<li>trun_mvnt: https://github.com/ralphma1203/trun_mvnt?tab=readme-ov-file</li>
<li>StackOverflow: https://stackoverflow.com/questions/20115917/truncated-multivariate-normal-in-scipy</li>
</ul>
<p>Univariate Skew Normal: - http://azzalini.stat.unipd.it/SN/Intro/intro.html</p>
</section>
<section id="truncated-skew-normal" class="level1">
<h1>Truncated Skew-Normal</h1>
<div class="cell-container"><div class="cell-decorator"><pre>In [566]:</pre></div><div id="1e290848e49d6b44" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:07.931421Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:07.928214Z&quot;}" data-execution_count="566">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw a sample</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> truncated_skew_normal(loc: <span class="bu">float</span>, scale: <span class="bu">float</span>, skew: <span class="bu">float</span>, a: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, b: <span class="bu">float</span> <span class="op">=</span> <span class="dv">1</span>, num_samples: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>):</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters for the skew-normal distribution</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delta = skew / np.sqrt(1 + skew**2)</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delta = skew</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rejection sampling</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> []</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(samples) <span class="op">&lt;</span> num_samples:</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        candidate <span class="op">=</span> stats.skewnorm.rvs(a<span class="op">=</span>skew, loc<span class="op">=</span>loc, scale<span class="op">=</span>scale)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&lt;=</span> candidate <span class="op">&lt;=</span> b:</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>            samples.append(candidate)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(samples)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_skew_moments(samples: np.array):</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    skew, loc, scale <span class="op">=</span> stats.skewnorm.fit(samples)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> loc, scale, skew</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trunc_skewnorm_2d(loc: <span class="bu">tuple</span>, scale: <span class="bu">tuple</span>, skew: <span class="bu">tuple</span>, a: <span class="bu">tuple</span> <span class="op">=</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), b: <span class="bu">tuple</span> <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">1</span>), num_samples<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> np.array(</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                truncated_skew_normal(loc[<span class="dv">0</span>], scale[<span class="dv">0</span>], skew[<span class="dv">0</span>], a[<span class="dv">0</span>], b[<span class="dv">0</span>], num_samples),</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                truncated_skew_normal(loc[<span class="dv">1</span>], scale[<span class="dv">1</span>], skew[<span class="dv">1</span>], a[<span class="dv">1</span>], b[<span class="dv">1</span>], num_samples)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>            ).T</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_skew_moments_2d(samples: np.array):</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    loc_0, scale_0, skew_0 <span class="op">=</span> estimate_skew_moments(samples[:, <span class="dv">0</span>])</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    loc_1, scale_1, skew_1 <span class="op">=</span> estimate_skew_moments(samples[:, <span class="dv">1</span>])</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (loc_0, loc_1), (scale_0, scale_1), (skew_0, skew_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>Note that the location, scale, and skew/shape parameters (referred to as â€˜direct parametersâ€™ by Azzalini) are distinct from the mean, covariance, and skewness parameters (referred to as â€˜centred parametersâ€™). http://azzalini.stat.unipd.it/SN/Intro/intro.html</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [567]:</pre></div><div id="cfce294b21474367" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:08.232038Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:07.931703Z&quot;}" data-execution_count="567">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="co"># loc_s, scale_s, skew_s = (0.377, 0.0827, -0.083)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print((loc_s, scale_s, skew_s))</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># s_data = truncated_skew_normal(loc_s, scale_s, skew_s, num_samples=10000)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>s_data <span class="op">=</span> test_data[<span class="st">'ISOPleasant'</span>].to_numpy()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>loc_p, scale_p, skew_p <span class="op">=</span> estimate_skew_moments(s_data)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>p_data <span class="op">=</span> truncated_skew_normal(loc_p, scale_p, skew_p, num_samples<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>((loc_p, scale_p, skew_p))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pdfs</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>plt.hist(p_data, bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.hist(s_data, bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> plt.xlim()</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> stats.skewnorm.pdf(x, skew_p, loc_p, scale_p)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p, <span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.8186226102942695, 0.6859803261389701, -4.20548006334138)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-18-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="skewnorm_test_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [568]:</pre></div><div id="d02c9deefe718718" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:08.752005Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:08.233179Z&quot;}" data-execution_count="568">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> estimate_skew_moments_2d(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy())</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(targets)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>p_data <span class="op">=</span> trunc_skewnorm_2d(targets[<span class="dv">0</span>], targets[<span class="dv">1</span>], targets[<span class="dv">2</span>], num_samples<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>sample_moments <span class="op">=</span> estimate_skew_moments_2d(p_data)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_moments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>((0.8186226102942695, -0.33616237140375016), (0.6859803261389701, 0.39567973474924745), (-4.20548006334138, 3.116395598533704))
((0.8128313333487476, -0.33028171176693866), (0.6663039964642805, 0.3877676207947591), (-5.155976610981078, 2.9096536098316017))</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [569]:</pre></div><div id="c58dfbe0d486e526" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:08.933806Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:08.753520Z&quot;}" data-execution_count="569">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].hist(p_data[:, <span class="dv">0</span>], bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].hist(test_data[<span class="st">'ISOPleasant'</span>], bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> axes[<span class="dv">0</span>].get_xlim()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> stats.skewnorm.pdf(x, targets[<span class="dv">0</span>][<span class="dv">0</span>], targets[<span class="dv">1</span>][<span class="dv">0</span>], targets[<span class="dv">2</span>][<span class="dv">0</span>])</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(x, p, <span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].hist(p_data[:, <span class="dv">1</span>], bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].hist(test_data[<span class="st">'ISOEventful'</span>], bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> axes[<span class="dv">1</span>].get_xlim()</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> stats.skewnorm.pdf(x, targets[<span class="dv">0</span>][<span class="dv">1</span>], targets[<span class="dv">1</span>][<span class="dv">1</span>], targets[<span class="dv">2</span>][<span class="dv">1</span>])</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, p, <span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-20-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="skewnorm_test_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [570]:</pre></div><div id="808c8cbe269d41eb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:09.091102Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:08.937576Z&quot;}" data-execution_count="570">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>a, loc, scale <span class="op">=</span> stats.skewnorm.fit(test_data[<span class="st">'ISOPleasant'</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>p_data <span class="op">=</span> truncated_skew_normal(loc, scale, a, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate parameters from sample</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>ae, loce, scalee <span class="op">=</span> stats.skewnorm.fit(p_data)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pdfs</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.hist(p_data, bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>plt.hist(test_data[<span class="st">'ISOPleasant'</span>], bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> plt.xlim()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> stats.skewnorm.pdf(x, ae, loce, scalee)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p, <span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-21-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="skewnorm_test_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [571]:</pre></div><div id="fde9f15bf1f08d15" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:09.248424Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:09.092775Z&quot;}" data-execution_count="571">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>a, loc, scale <span class="op">=</span> stats.skewnorm.fit(test_data[<span class="st">'ISOEventful'</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>e_data <span class="op">=</span> truncated_skew_normal(loc, scale, a, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, num_samples<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate parameters from sample</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ae, loce, scalee <span class="op">=</span> stats.skewnorm.fit(e_data)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pdfs</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>plt.hist(e_data, bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>plt.hist(test_data[<span class="st">'ISOEventful'</span>], bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> plt.xlim()</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> stats.skewnorm.pdf(x, ae, loce, scalee)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p, <span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-22-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="skewnorm_test_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [572]:</pre></div><div id="c889cc71eac400db" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:09.272720Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:09.249011Z&quot;}" data-execution_count="572">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils <span class="im">import</span> spi</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>target_data <span class="op">=</span> pd.DataFrame(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ISOPleasant'</span>: p_data,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ISOEventful'</span>: e_data</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>spi(test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]], target_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="572">
<pre><code>86</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [573]:</pre></div><div id="5c8bb05dc6ac9393" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:09.827456Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:09.272357Z&quot;}" data-execution_count="573">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-24-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="skewnorm_test_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [574]:</pre></div><div id="2f8a2682598aec32" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:10.614529Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:09.832398Z&quot;}" data-execution_count="574">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(target_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-25-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="skewnorm_test_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [575]:</pre></div><div id="80c6c847c135c166" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:10.647488Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:10.620305Z&quot;}" data-execution_count="575">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>spi(sspy.isd.select_location_ids(data, <span class="st">'SanMarco'</span>), target_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="575">
<pre><code>43</code></pre>
</div>
</div></div>
</section>
<section id="multivariate-skew-normal" class="level1">
<h1>Multivariate Skew-Normal</h1>
<div class="cell-container"><div class="cell-decorator"><pre>In [576]:</pre></div><div id="292d847bf748a690" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:10.647565Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:10.644197Z&quot;}" data-execution_count="576">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> (multivariate_normal <span class="im">as</span> mvn,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                         norm</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats._multivariate <span class="im">import</span> _squeeze_output</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> multivariate_skewnorm:</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># from: https://gregorygundersen.com/blog/2020/12/29/multivariate-skew-normal/</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, shape, mean<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">0</span>), cov<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dim <span class="op">=</span> <span class="bu">len</span>(shape)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.shape <span class="op">=</span> np.asarray(shape)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean <span class="op">=</span> np.asarray(mean)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cov <span class="op">=</span> np.eye(<span class="va">self</span>.dim) <span class="cf">if</span> cov <span class="kw">is</span> <span class="va">None</span> <span class="cf">else</span> np.asarray(cov)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> pdf(<span class="va">self</span>, x):</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.exp(<span class="va">self</span>.logpdf(x))</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> logpdf(<span class="va">self</span>, x):</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> mvn._process_quantiles(x, <span class="va">self</span>.dim)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        pdf <span class="op">=</span> mvn(<span class="va">self</span>.mean, <span class="va">self</span>.cov).logpdf(x)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        cdf <span class="op">=</span> norm(<span class="dv">0</span>, <span class="dv">1</span>).logcdf(np.dot(x, <span class="va">self</span>.shape))</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> _squeeze_output(np.log(<span class="dv">2</span>) <span class="op">+</span> pdf <span class="op">+</span> cdf)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rvs_slow(<span class="va">self</span>, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># K-variate normal density</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        std_mvn <span class="op">=</span> mvn(<span class="va">self</span>.mean,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>                      <span class="va">self</span>.cov</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.empty((size, <span class="va">self</span>.dim))</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply rejection sampling.</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>        n_samples <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> n_samples <span class="op">&lt;</span> size:</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>            z <span class="op">=</span> std_mvn.rvs(size<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>            u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> std_mvn.pdf(z))</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> u <span class="op">&gt;</span> <span class="va">self</span>.pdf(z):</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>                x[n_samples] <span class="op">=</span> z</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>                n_samples <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rescale based on correlation matrix.</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># chol = np.linalg.cholesky(self.cov)</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># x = (chol @ x.T).T</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rvs_fast(<span class="va">self</span>, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>        aCa <span class="op">=</span> <span class="va">self</span>.shape <span class="op">@</span> <span class="va">self</span>.cov <span class="op">@</span> <span class="va">self</span>.shape</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        delta <span class="op">=</span> (<span class="dv">1</span> <span class="op">/</span> np.sqrt(<span class="dv">1</span> <span class="op">+</span> aCa)) <span class="op">*</span> <span class="va">self</span>.cov <span class="op">@</span> <span class="va">self</span>.shape</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>        cov_star <span class="op">=</span> np.block([[np.ones(<span class="dv">1</span>), delta],</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>                             [delta[:, <span class="va">None</span>], <span class="va">self</span>.cov]]</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> mvn(np.zeros(<span class="va">self</span>.dim <span class="op">+</span> <span class="dv">1</span>), cov_star).rvs(size)</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>        x0, x1 <span class="op">=</span> x[:, <span class="dv">0</span>], x[:, <span class="dv">1</span>:]</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>        inds <span class="op">=</span> x0 <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>        x1[inds] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span> <span class="op">*</span> x1[inds]</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x1</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_moments(samples):</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate sample mean</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    sample_mean <span class="op">=</span> np.mean(samples, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate sample covariance matrix</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>    sample_cov_matrix <span class="op">=</span> np.cov(samples, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Center the samples</span></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    centered_samples <span class="op">=</span> samples <span class="op">-</span> sample_mean</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate skewness matrix using the centered samples</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    skewness_matrix <span class="op">=</span> np.mean(centered_samples <span class="op">**</span> <span class="dv">3</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> np.std(centered_samples, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_mean, sample_cov_matrix, skewness_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [577]:</pre></div><div id="3cec416714bef259" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:12.366318Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:10.647382Z&quot;}" data-execution_count="577">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>estimated_mean, estimated_cov_matrix, estimated_skewness <span class="op">=</span> estimate_moments(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Mean:"</span>, estimated_mean)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Covariance Matrix:"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(estimated_cov_matrix)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Skewness:"</span>, estimated_skewness)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> {</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mean'</span>: (<span class="fl">0.224</span>, <span class="fl">0.377</span>),</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'cov'</span> : np.array([[<span class="fl">0.099</span>, <span class="op">-</span><span class="fl">0.018</span>], [<span class="op">-</span><span class="fl">0.0183</span>, <span class="fl">0.0827</span>]]),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'skew'</span>: (<span class="fl">0.089</span>, <span class="op">-</span><span class="fl">0.083</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> multivariate_skewnorm(shape<span class="op">=</span>estimated_skewness, cov<span class="op">=</span>estimated_cov_matrix, mean<span class="op">=</span>estimated_mean).rvs_slow(<span class="dv">1000</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># test_df = multivariate_skewnorm(shape=targets['skew'], cov=targets['cov'], mean=targets['mean']).rvs_slow(1000)</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.DataFrame(test_df, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(test_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Mean: [ 0.27909904 -0.03652308]
Estimated Covariance Matrix:
[[ 0.18122578 -0.02137291]
 [-0.02137291  0.06742474]]
Estimated Skewness: [-0.45149117  0.73468857]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-28-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="skewnorm_test_files/figure-html/cell-28-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [578]:</pre></div><div id="d221ef9a936f12af" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:12.972522Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:12.369439Z&quot;}" data-execution_count="578">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-29-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="skewnorm_test_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [579]:</pre></div><div id="5a86f0d68a0d5f25" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:24:13.009174Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:24:12.978120Z&quot;}" data-execution_count="579">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>spi(sspy.isd.select_location_ids(data, <span class="st">'SanMarco'</span>), test_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="579">
<pre><code>46</code></pre>
</div>
</div></div>
<section id="r-sn" class="level2">
<h2 class="anchored" data-anchor-id="r-sn">R SN</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div id="c0aa8bc4c9c8561c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:34:38.049272Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:34:38.024652Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpyskewnorm <span class="im">as</span> snpy</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.4</span>], [<span class="fl">0.4</span>, <span class="fl">0.6</span>]])</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> (<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>skew <span class="op">=</span> (<span class="dv">0</span>, <span class="op">-</span><span class="fl">0.6</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>beta, omega, alpha <span class="op">=</span> snpy.skewnormal_parms_2d(mean, sigma, skew)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(beta, omega, alpha)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> snpy.rnd_skewnormal_2d(beta, omega, alpha, size<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 0.         -0.13389297] [[1.         0.4       ]
 [0.4        1.35014139]] [  3.66054584 -10.63348162]</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'mean' is not defined</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="a88f1514ff064590" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-02T16:34:40.142686Z&quot;,&quot;start_time&quot;:&quot;2024-02-02T16:34:39.984521Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> test_data[<span class="st">'ISOEventful'</span>].mean()</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> test_data[<span class="st">'ISOEventful'</span>].std()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>skew <span class="op">=</span> test_data[<span class="st">'ISOEventful'</span>].skew()</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mean, std, skew)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>beta, omega, alpha <span class="op">=</span> snpy.skewnormal_parms(mean, std, skew)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(beta, omega, alpha)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> snpy.rnd_skewnormal(beta, omega, alpha, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the pdfs</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>plt.hist(y, bins<span class="op">=</span><span class="dv">100</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>plt.hist(test_data[<span class="st">'ISOEventful'</span>], bins<span class="op">=</span><span class="dv">21</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>xmin, xmax <span class="op">=</span> plt.xlim()</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(xmin, xmax, <span class="dv">100</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-0.03652307692307693 0.2596627369069606 0.745484116696089
-0.3486524345620716 0.4060165918261776 3.598957128011734</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-32-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="skewnorm_test_files/figure-html/cell-32-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="end" class="level2">
<h2 class="anchored" data-anchor-id="end">End</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [203]:</pre></div><div id="8bd88768dd48a512" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-01-31T23:45:13.408943Z&quot;,&quot;start_time&quot;:&quot;2024-01-31T23:45:13.376816Z&quot;}" data-execution_count="203">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multivariate_skew_normal(mean, cov_matrix, skewness, size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    dim <span class="op">=</span> <span class="bu">len</span>(mean)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate samples from the multivariate normal distribution</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    normal_samples <span class="op">=</span> multivariate_normal.rvs(mean<span class="op">=</span>mean, cov<span class="op">=</span>cov_matrix, size<span class="op">=</span>size)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate samples from the skewness distribution</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    skew_samples <span class="op">=</span> skewnorm.rvs(skewness, size<span class="op">=</span>(size, dim))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine the normal samples and skew samples</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    skewed_samples <span class="op">=</span> normal_samples <span class="op">+</span> skew_samples</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> skewed_samples</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>mean_vector <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>covariance_matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">0.9</span>], [<span class="fl">0.9</span>, <span class="dv">1</span>]])</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>skewness_parameter <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> multivariate_skew_normal(mean_vector, covariance_matrix, skewness_parameter, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Mean:"</span>, np.mean(samples, axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Covariance Matrix:"</span>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.cov(samples, rowvar<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Mean: [1.70380847 0.66459427]
Sample Covariance Matrix:
[[1.55894132 0.93562762]
 [0.93562762 1.54235095]]</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [204]:</pre></div><div id="10f358320ca5bce2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-01-31T23:45:15.105145Z&quot;,&quot;start_time&quot;:&quot;2024-01-31T23:45:14.520799Z&quot;}" data-execution_count="204">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="op">=</span> pd.DataFrame(samples, columns<span class="op">=</span>[<span class="st">'x'</span>, <span class="st">'y'</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sns.jointplot(data<span class="op">=</span>test_df, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, kind<span class="op">=</span><span class="st">'kde'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-34-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="skewnorm_test_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [209]:</pre></div><div id="a9f70070ac3e5815" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-01-31T23:47:04.331171Z&quot;,&quot;start_time&quot;:&quot;2024-01-31T23:47:03.668318Z&quot;}" data-execution_count="209">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> multivariate_skew_normal(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>        mean<span class="op">=</span>test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].mean().to_numpy(),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        cov_matrix<span class="op">=</span>test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].cov().to_numpy(),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        skewness<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> pd.DataFrame(samples, columns<span class="op">=</span>[<span class="st">'x'</span>, <span class="st">'y'</span>])</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>sns.jointplot(data<span class="op">=</span>samples, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, kind<span class="op">=</span><span class="st">'kde'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-35-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="skewnorm_test_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [213]:</pre></div><div id="e0c3a556b0ef50e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-01-31T23:51:25.950638Z&quot;,&quot;start_time&quot;:&quot;2024-01-31T23:51:25.850732Z&quot;}" data-execution_count="213">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> multivariate_normal, skewnorm</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit_multivariate_skew_normal(samples):</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    dim <span class="op">=</span> samples.shape[<span class="dv">1</span>]</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Function to minimize (negative log-likelihood)</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> negative_log_likelihood(params):</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        mean <span class="op">=</span> params[:dim]</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        cov_matrix <span class="op">=</span> np.diag(np.exp(params[dim:<span class="dv">2</span> <span class="op">*</span> dim]))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>        skewness <span class="op">=</span> params[<span class="dv">2</span> <span class="op">*</span> dim:]</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate log-likelihood</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        normal_density <span class="op">=</span> multivariate_normal.logpdf(samples, mean<span class="op">=</span>mean, cov<span class="op">=</span>cov_matrix)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        skew_density <span class="op">=</span> skewnorm.logpdf((samples <span class="op">-</span> mean) <span class="op">/</span> np.sqrt(np.diag(cov_matrix)), skewness)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>np.<span class="bu">sum</span>(normal_density <span class="op">+</span> skew_density)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initial guess for parameters</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    initial_params <span class="op">=</span> np.concatenate(</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>            [samples.mean(axis<span class="op">=</span><span class="dv">0</span>), np.log(np.diag(np.cov(samples, rowvar<span class="op">=</span><span class="va">False</span>))), np.zeros(dim)]</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optimize the negative log-likelihood</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> minimize(negative_log_likelihood, initial_params, method<span class="op">=</span><span class="st">'L-BFGS-B'</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract parameters from the optimized result</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    fitted_mean <span class="op">=</span> result.x[:dim]</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    fitted_cov_matrix <span class="op">=</span> np.diag(np.exp(result.x[dim:<span class="dv">2</span> <span class="op">*</span> dim]))</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    fitted_skewness <span class="op">=</span> result.x[<span class="dv">2</span> <span class="op">*</span> dim:]</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fitted_mean, fitted_cov_matrix, fitted_skewness</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume 'data' is a 2D array of samples</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.multivariate_normal(mean<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">3</span>], cov<span class="op">=</span>[[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">2</span>]], size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>fit_mean, fit_cov_matrix, fit_skewness <span class="op">=</span> fit_multivariate_skew_normal(data)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fitted Mean:"</span>, fit_mean)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fitted Covariance Matrix:"</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fit_cov_matrix)</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fitted Skewness:"</span>, fit_skewness)</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: operands could not be broadcast together with shapes (1000,) (1000,2) </code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [233]:</pre></div><div id="34fbc5699dad57ad" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:04:42.026967Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:04:42.008524Z&quot;}" data-execution_count="233">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> multivariate_normal.rvs([<span class="dv">2</span>, <span class="dv">3</span>], [[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">2</span>]]) <span class="op">+</span> skewnorm.rvs([<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>sample[<span class="dv">0</span>] <span class="op">&lt;</span> <span class="dv">1</span> <span class="kw">and</span> sample[<span class="dv">1</span>] <span class="op">&lt;</span> <span class="dv">1</span> <span class="kw">and</span> sample[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span> <span class="kw">and</span> sample[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre><code>True</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [298]:</pre></div><div id="d24265db8caafeca" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:41:26.805701Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:41:26.616162Z&quot;}" data-execution_count="298">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> multivariate_normal, skewnorm</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sample_bivariate_skew_normal(size, location, covariance, skewness, a<span class="op">=-</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rejection sampling</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> []</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(samples) <span class="op">&lt;</span> size:</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        candidate <span class="op">=</span> multivariate_normal.rvs(mean<span class="op">=</span>location, cov<span class="op">=</span>covariance) <span class="op">*</span> skewnorm.rvs(skewness)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&lt;=</span> candidate[<span class="dv">0</span>] <span class="op">&lt;=</span> b <span class="kw">and</span> a <span class="op">&lt;=</span> candidate[<span class="dv">1</span>] <span class="op">&lt;=</span> b:</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>            samples.append(candidate)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> samples</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>location <span class="op">=</span> [<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>covariance <span class="op">=</span> [[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">2</span>]]</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>skewness <span class="op">=</span> [<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> sample_bivariate_skew_normal(size, location, covariance, skewness)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Print mean and covariance matrix of the generated samples</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Mean:"</span>, np.mean(samples, axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample Covariance Matrix:"</span>)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.cov(samples, rowvar<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Mean: [0.09059921 0.0597697 ]
Sample Covariance Matrix:
[[ 0.1769003  -0.00457141]
 [-0.00457141  0.20086224]]</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [299]:</pre></div><div id="50f4f68bece18034" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:41:32.389415Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:41:32.370906Z&quot;}" data-execution_count="299">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_moments(samples):</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate sample mean</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    sample_mean <span class="op">=</span> np.mean(samples, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate sample covariance matrix</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    sample_cov_matrix <span class="op">=</span> np.cov(samples, rowvar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Center the samples</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    centered_samples <span class="op">=</span> samples <span class="op">-</span> sample_mean</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate skewness matrix using the centered samples</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    skewness_matrix <span class="op">=</span> np.mean(centered_samples <span class="op">**</span> <span class="dv">3</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> np.std(centered_samples, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sample_mean, sample_cov_matrix, skewness_matrix</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume 'data' is a 2D array of samples</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.multivariate_normal(mean<span class="op">=</span>[<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>], cov<span class="op">=</span>[[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">2</span>]], size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate moments</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>estimated_mean, estimated_cov_matrix, estimated_skewness <span class="op">=</span> estimate_moments(data)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Mean:"</span>, estimated_mean)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Covariance Matrix:"</span>)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(estimated_cov_matrix)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Skewness:"</span>, estimated_skewness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Mean: [ 0.43266242 -0.56365521]
Estimated Covariance Matrix:
[[1.01840587 0.47906665]
 [0.47906665 1.90171325]]
Estimated Skewness: [0.04232562 0.19124746]</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [300]:</pre></div><div id="a8267402d7431d7a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:41:33.465394Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:41:33.447989Z&quot;}" data-execution_count="300">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>estimated_mean, estimated_cov_matrix, estimated_skewness <span class="op">=</span> estimate_moments(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    test_data[[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>]].to_numpy()</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Mean:"</span>, estimated_mean)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Covariance Matrix:"</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(estimated_cov_matrix)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated Skewness:"</span>, estimated_skewness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Mean: [0.25715484 0.07943226]
Estimated Covariance Matrix:
[[ 0.15379664 -0.02063052]
 [-0.02063052  0.08202177]]
Estimated Skewness: [-0.36778486 -0.40921456]</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [301]:</pre></div><div id="f06a00fcb4bf427e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:41:35.031639Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:41:34.178584Z&quot;}" data-execution_count="301">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> sample_bivariate_skew_normal(location<span class="op">=</span>estimated_mean, covariance<span class="op">=</span>estimated_cov_matrix,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                                    skewness<span class="op">=</span>estimated_skewness, size<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'ISOPleasant'</span>, <span class="st">'ISOEventful'</span>])</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>sspy.plotting.jointplot(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="skewnorm_test_files/figure-html/cell-41-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="skewnorm_test_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [302]:</pre></div><div id="20168b3903880212" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-01T00:41:45.551748Z&quot;,&quot;start_time&quot;:&quot;2024-02-01T00:41:45.514886Z&quot;}" data-execution_count="302">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="302">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ISOPleasant</th>
<th data-quarto-table-cell-role="th">ISOEventful</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.273049</td>
<td>0.076969</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.302629</td>
<td>-0.203748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.463852</td>
<td>-0.063422</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.121700</td>
<td>-0.037437</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.576033</td>
<td>-0.138067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">995</td>
<td>0.030473</td>
<td>0.245347</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">996</td>
<td>0.011258</td>
<td>-0.212560</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">997</td>
<td>-0.180243</td>
<td>-0.952178</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">998</td>
<td>-0.151068</td>
<td>0.062439</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999</td>
<td>-0.541194</td>
<td>0.014941</td>
</tr>
</tbody>
</table>

<p>1000 rows Ã— 2 columns</p>
</div>
</div>
</div>
</div></div>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","selector":".lightbox","loop":false,"descPosition":"bottom","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script> 
  
</body></html>